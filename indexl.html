<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Multiplayer A-Frame Game</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <!-- For terrain generation using procedural noise -->
    <script src="urizen.js"></script>
    <!-- Pointer lock controls for free look -->
    <script src="pointer-lock.js"></script>
    <script src="game.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        #connection-status {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 5px;
            border-radius: 5px;
            z-index: 999;
        }
    </style>
</head>
<body>
    <div id="connection-status">Connection status: Disconnected</div>
    
    <!-- color: #00CBFF -->
    <a-scene pointer-lock-controls fog="type: linear; color: #000; far:365;">
        <!-- Player with terrain locomotion system -->
        <a-entity id="player" position="0 25 0" terrain-movement="height: 4.6">
            <a-camera id="cam" wasd-controls="enabled: false" look-controls="enabled: false">
                <!-- micro HUD Interface -->
                <a-entity id="micro-hud">
                    <!-- Background panel -->
                    <a-plane position="0 -1.0 -3"
                                width="3.0" height="0.6"
                                material="color: #EEE; opacity: 0.2; depthTest: false">
                                <a-text  
                                    id="micro-hud-text"
                                    value="Loading..."
                                    position="0 0 0.01"
                                    scale="1 1 1" 
                                    align="center"
                                    color="#000">
                                </a-text>
                        </a-plane>
                </a-entity>
                <!-- Reticle for interaction -->
                <a-entity raycaster="objects: .clickable;" cursor="rayOrigin: mouse"></a-entity>
                <a-entity
                    id="reticle"
                    cursor="fuse:true;fuseTimeout:720;"
                    raycaster="objects:.clickable; far:32;"
                    geometry="primitive:ring;radiusInner: 0.01; radiusOuter: 0.03"
                    material="shader:flat;color:#077;
                                depthTest:true;
                                transparent:false; opacity:0.4;"
                    position="0 0 -1;"
                    animation__fusing="property:scale;from:1 1 1;to:0 0 0;dur:720;startEvents:fusing;"
                    animation__reset="property:scale;from:0 0 0;to: 1 1 1;dur:333;startEvents:mouseleave;">
                </a-entity>
            </a-camera>
            
            <!-- Sky -->
            <a-sky color="#16161d"></a-sky>
            
            <!-- Light source -->
            <a-entity
                light="type: point;
                    color: #FF0000;
                    intensity: 6.0;
                    distance: 0;
                    decay: 0;
                    castShadow: true"
                position="0 64 -64">
            </a-entity>
        </a-entity>
        
        <!-- Other player entities container (created via WebSocket) -->
        <a-entity id="players"></a-entity>
        
        <!-- Terrain generation -->
        <a-entity terrain-generator></a-entity>
        
        <!-- HUD for displaying info (needed by a-loco.js) -->
        <!-- <a-entity id="hud" position="0 999 0"></a-entity> -->
        <!-- HUD interactions for settings. NB before a-loco. -->
        <script src="HUD_menu.js"></script>
    </a-scene>
    
    <!-- Movement system -->
    <script src="a-loco.js"></script>
</body>
</html>